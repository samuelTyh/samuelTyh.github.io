<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Implementing Fivetran Data Source Connector with AWS Lambda" />
<meta property="og:locale" content="en" />
<meta name="description" content="Basic background of AWS Lambda" />
<meta property="og:description" content="Basic background of AWS Lambda" />
<link rel="canonical" href="http://localhost:4000/posts/implementing-fivetran-data-source-connector-with-aws-lambda/" />
<meta property="og:url" content="http://localhost:4000/posts/implementing-fivetran-data-source-connector-with-aws-lambda/" />
<meta property="og:site_name" content="samueltyh" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-28T22:47:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Implementing Fivetran Data Source Connector with AWS Lambda" />
<meta name="twitter:site" content="@samueltyh" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-28T22:47:00+02:00","datePublished":"2022-05-28T22:47:00+02:00","description":"Basic background of AWS Lambda","headline":"Implementing Fivetran Data Source Connector with AWS Lambda","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/implementing-fivetran-data-source-connector-with-aws-lambda/"},"url":"http://localhost:4000/posts/implementing-fivetran-data-source-connector-with-aws-lambda/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Implementing Fivetran Data Source Connector with AWS Lambda | samueltyh
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">



  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/AvatarMaker.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">samueltyh</a>
    <p class="site-subtitle fst-italic mb-0">Data Engineering, Learning by making, Career reflections</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tag"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    

      
        <a
          href="https://github.com/samueltyh"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    

      
        <a
          href="https://twitter.com/samueltyh"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    

      
        <a
          href="javascript:location.href = 'mailto:' + ['samuel.tseng.de','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
          
        

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Implementing Fivetran Data Source Connector with AWS Lambda</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- add class to exist <a> tag -->
        
        
        

      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Implementing Fivetran Data Source Connector with AWS Lambda</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1653770820"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  May 28, 2022
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/samueltyh">Samuel Tseng</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="986 words"
>
  <em>5 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Implementing Fivetran Data Source Connector with AWS Lambda</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Implementing Fivetran Data Source Connector with AWS Lambda</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h2 id="basic-background-of-aws-lambda"><span class="me-2">Basic background of AWS Lambda</span><a href="#basic-background-of-aws-lambda" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><a href="https://aws.amazon.com/getting-started/hands-on/run-serverless-code/">Official developer guide from AWS</a></p>

<p>AWS Lambda is a serverless, event-driven compute service that lets you run code for virtually any type of application or backend service without provisioning or managing servers. In GCP and Azure, we can implement the same idea via Cloud Functions and Azure Funtions.</p>

<h2 id="why-is-it-necessary-to-understand-lambda-to-build-fivetran-connectors"><span class="me-2">Why is it necessary to understand Lambda to build Fivetran connectors?</span><a href="#why-is-it-necessary-to-understand-lambda-to-build-fivetran-connectors" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Fivetran is a reliable data pipeline platform for business users to connect their data source in a convenient way. It provides tons of connectors and integrations for user to choose, like marketing tools, modern databases, etc. Although Fivetran supports amounts of external APIs and data sources integration in default, some of the external APIs we needin reality which doesn’t be supported by Fivetran directly.</p>

<p>If you are using AWS, then Lambda stands out at this moment! It allows us to write custom integration functions in Python, Node.js, etc. to approach data integration which not directly supported by Fivetran. In the following use case, connector/ETL was built in Python, connecting an API and Snwoflake. But this article would only focus on the less mentioned parts of the official Fivetran documentation. The basic architecture is shown in the figure below.</p>

<p><a href="https://s3.eu-central-1.amazonaws.com/samueltyh.github.io/posts/Fivetran_lambda.drawio.png">
          class="img-link shimmer"
        ><img src="https://s3.eu-central-1.amazonaws.com/samueltyh.github.io/posts/Fivetran_lambda.drawio.png" alt="" loading="lazy"></a></p>

<h2 id="prerequisite"><span class="me-2">Prerequisite</span><a href="#prerequisite" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Follow the instruction from Fivetran to setup the configuration, click <a href="https://fivetran.com/docs/functions/aws-lambda">here</a></p>

<p>Lambda’s sample function from Fivetran’s document</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">json</span>
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="c1"># Fetch records using api calls
</span>    <span class="p">(</span><span class="n">insertTransactions</span><span class="p">,</span> <span class="n">deleteTransactions</span><span class="p">,</span> <span class="n">newTransactionCursor</span><span class="p">)</span> <span class="o">=</span> <span class="nf">api_response</span><span class="p">(</span><span class="n">request</span><span class="p">[</span><span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">],</span> <span class="n">request</span><span class="p">[</span><span class="sh">'</span><span class="s">secrets</span><span class="sh">'</span><span class="p">])</span>    
    <span class="c1"># Populate records in insert    
</span>    <span class="n">insert</span> <span class="o">=</span> <span class="p">{}</span>    
    <span class="n">insert</span><span class="p">[</span><span class="sh">'</span><span class="s">transactions</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">insertTransactions</span>    
    <span class="n">delete</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">delete</span><span class="p">[</span><span class="sh">'</span><span class="s">transactions</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">deleteTransactions</span>    
    <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">state</span><span class="p">[</span><span class="sh">'</span><span class="s">transactionsCursor</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">newTransactionCursor</span>    
    <span class="n">transactionsSchema</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">transactionsSchema</span><span class="p">[</span><span class="sh">'</span><span class="s">primary_key</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">order_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">date</span><span class="sh">'</span><span class="p">]</span>    
    <span class="n">schema</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">schema</span><span class="p">[</span><span class="sh">'</span><span class="s">transactions</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">transactionsSchema</span>    
    <span class="n">response</span> <span class="o">=</span> <span class="p">{}</span>    
    <span class="c1"># Add updated state to response
</span>    <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span>  <span class="n">state</span>    
    <span class="c1"># Add all the records to be inserted in response
</span>    <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">insert</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">insert</span>    
    <span class="c1"># Add all the records to be marked as deleted in response
</span>    <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">delete</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">delete</span>    
    <span class="c1"># Add schema defintion in response
</span>    <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">schema</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">schema</span>    
    <span class="c1"># Add hasMore flag
</span>    <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">hasMore</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">false</span><span class="sh">'</span>    
    <span class="k">return</span> <span class="n">response</span>	
<span class="k">def</span> <span class="nf">api_response</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">secrets</span><span class="p">):</span>
    <span class="c1"># your api call goes here
</span>    <span class="n">insertTransactions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span><span class="sh">"</span><span class="s">date</span><span class="sh">"</span><span class="p">:</span><span class="sh">'</span><span class="s">2017-12-31T05:12:05Z</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">order_id</span><span class="sh">"</span><span class="p">:</span><span class="mi">1001</span><span class="p">,</span> <span class="sh">"</span><span class="s">amount</span><span class="sh">"</span><span class="p">:</span><span class="sh">'</span><span class="s">$1200</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">discount</span><span class="sh">"</span><span class="p">:</span><span class="sh">'</span><span class="s">$12</span><span class="sh">'</span><span class="p">},</span>
            <span class="p">{</span><span class="sh">"</span><span class="s">date</span><span class="sh">"</span><span class="p">:</span><span class="sh">'</span><span class="s">2017-12-31T06:12:04Z</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">order_id</span><span class="sh">"</span><span class="p">:</span><span class="mi">1001</span><span class="p">,</span> <span class="sh">"</span><span class="s">amount</span><span class="sh">"</span><span class="p">:</span><span class="sh">'</span><span class="s">$1200</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">discount</span><span class="sh">"</span><span class="p">:</span><span class="sh">'</span><span class="s">$12</span><span class="sh">'</span><span class="p">},</span>
    <span class="p">]</span>    
    <span class="n">deleteTransactions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span><span class="sh">"</span><span class="s">date</span><span class="sh">"</span><span class="p">:</span><span class="sh">'</span><span class="s">2017-12-31T05:12:05Z</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">order_id</span><span class="sh">"</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="sh">"</span><span class="s">amount</span><span class="sh">"</span><span class="p">:</span><span class="sh">'</span><span class="s">$1200</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">discount</span><span class="sh">"</span><span class="p">:</span><span class="sh">'</span><span class="s">$12</span><span class="sh">'</span><span class="p">},</span>
            <span class="p">{</span><span class="sh">"</span><span class="s">date</span><span class="sh">"</span><span class="p">:</span><span class="sh">'</span><span class="s">2017-12-31T06:12:04Z</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">order_id</span><span class="sh">"</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="sh">"</span><span class="s">amount</span><span class="sh">"</span><span class="p">:</span><span class="sh">'</span><span class="s">$1200</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">discount</span><span class="sh">"</span><span class="p">:</span><span class="sh">'</span><span class="s">$12</span><span class="sh">'</span><span class="p">},</span>
    <span class="p">]</span>    
    <span class="nf">return </span><span class="p">(</span><span class="n">insertTransactions</span><span class="p">,</span> <span class="n">deleteTransactions</span><span class="p">,</span> <span class="sh">'</span><span class="s">2018-01-01T00:00:00Z</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="multi-pages-response-implementation"><span class="me-2">Multi-pages response implementation</span><a href="#multi-pages-response-implementation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Fivetran will stop the request if it gets a response has an attribute <code class="language-plaintext highlighter-rouge">hasMore</code> which equals <code class="language-plaintext highlighter-rouge">'false'</code></p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">hasMore</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">false</span><span class="sh">'</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Which means, more than 1 pages response should be able to switch the value by a pointer. <code class="language-plaintext highlighter-rouge">false</code> should be able to altered to make Fivetran know that the request hasn’t finished, the pointer should be updated as well once all pages are done. I’m sharing my implementation below to meet this requirement.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="n">asyncio</span>
<span class="kn">from</span> <span class="n">services</span> <span class="kn">import</span> <span class="n">processor</span><span class="p">,</span> <span class="n">cursor_formatter</span>


<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    Lambda function handler to handle output format
    </span><span class="sh">"""</span>
    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">get_event_loop</span><span class="p">()</span>
    <span class="n">insertLoanApplication</span><span class="p">,</span> <span class="n">insertApplicants</span><span class="p">,</span> <span class="n">insertAdvisors</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> \
        <span class="n">loop</span><span class="p">.</span><span class="nf">run_until_complete</span><span class="p">(</span><span class="nf">api_response</span><span class="p">(</span><span class="n">event</span><span class="p">[</span><span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">],</span> <span class="n">event</span><span class="p">[</span><span class="sh">'</span><span class="s">secrets</span><span class="sh">'</span><span class="p">]))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">state</span><span class="p">[</span><span class="sh">'</span><span class="s">moreData</span><span class="sh">'</span><span class="p">]:</span>
        <span class="n">loop</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

    <span class="n">insert</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">loan_applications</span><span class="sh">'</span><span class="p">:</span> <span class="n">insertLoanApplication</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">applicants</span><span class="sh">'</span><span class="p">:</span> <span class="n">insertApplicants</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">advisors</span><span class="sh">'</span><span class="p">:</span> <span class="n">insertAdvisors</span>
    <span class="p">}</span>

    <span class="n">schema_loan_applications</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">primary_key</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">]}</span>
    <span class="n">schema_applicants</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">primary_key</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">loan_application_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">]}</span>
    <span class="n">schema_advisors</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">primary_key</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">]}</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">loan_applications</span><span class="sh">'</span><span class="p">:</span> <span class="n">schema_loan_applications</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">applicants</span><span class="sh">'</span><span class="p">:</span> <span class="n">schema_applicants</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">advisors</span><span class="sh">'</span><span class="p">:</span> <span class="n">schema_advisors</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">:</span> <span class="n">state</span> <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="sh">'</span><span class="s">moreData</span><span class="sh">'</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span><span class="sh">'</span><span class="s">cursor</span><span class="sh">'</span><span class="p">:</span> <span class="nf">cursor_formatter</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()),</span>
                                                  <span class="sh">'</span><span class="s">page</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
        <span class="sh">'</span><span class="s">insert</span><span class="sh">'</span><span class="p">:</span> <span class="n">insert</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">schema</span><span class="sh">'</span><span class="p">:</span> <span class="n">schema</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">hasMore</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">false</span><span class="sh">'</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">state</span><span class="p">[</span><span class="sh">'</span><span class="s">moreData</span><span class="sh">'</span><span class="p">]</span> <span class="k">else</span> <span class="sh">'</span><span class="s">true</span><span class="sh">'</span>
    <span class="p">}</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">api_response</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">secrets</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    Main function to call indicated API
    :param state: Fivetran anchor for indexing usage, default None
    :param secrets: The secret you would like to use to call the API
    :return: API responses
    </span><span class="sh">"""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">cursor_value</span><span class="p">,</span> <span class="n">page</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="sh">'</span><span class="s">cursor</span><span class="sh">'</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="sh">"</span><span class="s">page</span><span class="sh">"</span><span class="p">]</span>
    <span class="k">except</span> <span class="nb">KeyError</span><span class="p">:</span>
        <span class="n">cursor_value</span><span class="p">,</span> <span class="n">page</span> <span class="o">=</span> <span class="nf">cursor_formatter</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()),</span> <span class="mi">0</span>
    <span class="n">page</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">insertLoanApplication</span><span class="p">,</span> <span class="n">insertApplicant</span><span class="p">,</span> <span class="n">insertAdvisor</span><span class="p">,</span> <span class="n">moreData</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">processor</span><span class="p">(</span><span class="n">secrets</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="n">cursor_value</span><span class="p">)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">cursor</span><span class="sh">'</span><span class="p">:</span> <span class="n">cursor_value</span><span class="p">,</span> <span class="sh">'</span><span class="s">page</span><span class="sh">'</span><span class="p">:</span> <span class="n">page</span><span class="p">,</span> <span class="sh">'</span><span class="s">moreData</span><span class="sh">'</span><span class="p">:</span> <span class="n">moreData</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">insertLoanApplication</span><span class="p">,</span> <span class="n">insertApplicant</span><span class="p">,</span> <span class="n">insertAdvisor</span><span class="p">,</span> <span class="n">state</span>
</pre></td></tr></tbody></table></code></div></div>

<p>First, we can see in <code class="language-plaintext highlighter-rouge">api_request</code> function, <code class="language-plaintext highlighter-rouge">state</code> is assigned by request format, empty dictionary object in default, we can assign any pointer we need for requesting API, see <a href="https://fivetran.com/docs/functions/aws-lambda/sample-functions#samplefunctionrequest">here</a> to check the detail.</p>

<p>We retrieve the <code class="language-plaintext highlighter-rouge">cursor</code> and <code class="language-plaintext highlighter-rouge">page</code> at the beginning, cursor is for locating the timestamp of each response whether we’ve done already, and page is literally for locating which page we are at. Fivetran can tell if this is an initial request, or if it is a request that is still pending and should be continued.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="k">try</span><span class="p">:</span>
    <span class="n">cursor_value</span><span class="p">,</span> <span class="n">page</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="sh">'</span><span class="s">cursor</span><span class="sh">'</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="sh">"</span><span class="s">page</span><span class="sh">"</span><span class="p">]</span>
<span class="k">except</span> <span class="nb">KeyError</span><span class="p">:</span>
    <span class="n">cursor_value</span><span class="p">,</span> <span class="n">page</span> <span class="o">=</span> <span class="nf">cursor_formatter</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()),</span> <span class="mi">0</span>
</pre></td></tr></tbody></table></code></div></div>

<p>After processing, we will get a function return value <code class="language-plaintext highlighter-rouge">moreData</code> for the Lambda handler to continue or stop the request.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">state</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">cursor</span><span class="sh">'</span><span class="p">:</span> <span class="n">cursor_value</span><span class="p">,</span> <span class="sh">'</span><span class="s">page</span><span class="sh">'</span><span class="p">:</span> <span class="n">page</span><span class="p">,</span> <span class="sh">'</span><span class="s">moreData</span><span class="sh">'</span><span class="p">:</span> <span class="n">moreData</span><span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>In this example, we have the return value from the handler to present continuing or stopping. Else we have no more new response from API, returning a timestamp and reset the page value to 0 for the next round requesting.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">return</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">:</span> <span class="n">state</span> <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="sh">'</span><span class="s">moreData</span><span class="sh">'</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span><span class="sh">'</span><span class="s">cursor</span><span class="sh">'</span><span class="p">:</span> <span class="nf">cursor_formatter</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()),</span> <span class="sh">'</span><span class="s">page</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
    <span class="sh">'</span><span class="s">insert</span><span class="sh">'</span><span class="p">:</span> <span class="n">insert</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">schema</span><span class="sh">'</span><span class="p">:</span> <span class="n">schema</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">hasMore</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">false</span><span class="sh">'</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">state</span><span class="p">[</span><span class="sh">'</span><span class="s">moreData</span><span class="sh">'</span><span class="p">]</span> <span class="k">else</span> <span class="sh">'</span><span class="s">true</span><span class="sh">'</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Since the usage context is relatively small, Fivetran does not have document that describes how to request a multi-page response from API requesting, so we use several pointers to implement the requirements alone, which still quite fits actually.</p>

<p>If you’ve noticed, I’ve also designed asynchronous requests for this purpose to speed up request efficiency, but this also creates a burden on the API server, I’ll share how to optimize requests in a later post.</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/data-engineering/">Data Engineering</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/aws/"
            class="post-tag no-text-decoration"
          >aws</a>
        
          <a
            href="/tags/lambda/"
            class="post-tag no-text-decoration"
          >lambda</a>
        
          <a
            href="/tags/fivetran/"
            class="post-tag no-text-decoration"
          >fivetran</a>
        
          <a
            href="/tags/etl/"
            class="post-tag no-text-decoration"
          >etl</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Implementing%20Fivetran%20Data%20Source%20Connector%20with%20AWS%20Lambda%20-%20samueltyh&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fimplementing-fivetran-data-source-connector-with-aws-lambda%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Implementing%20Fivetran%20Data%20Source%20Connector%20with%20AWS%20Lambda%20-%20samueltyh&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fimplementing-fivetran-data-source-connector-with-aws-lambda%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fimplementing-fivetran-data-source-connector-with-aws-lambda%2F&text=Implementing%20Fivetran%20Data%20Source%20Connector%20with%20AWS%20Lambda%20-%20samueltyh" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/year-end-reflection-landing-a-new-job-in-2025/">Year end reflection: landing a new job in 2025</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/useful-gadget-sharing-cron-job-org/">Useful gadget sharing - cron-job.org</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/setting-both-celery-and-flask-inside-the-docker-compose/">Setting both Celery and Flask inside the docker-compose</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/free-n8n-hosting-leveraging-hugging-face-spaces-and-supabase-for-persistent-workflow-automation/">Free n8n Hosting: Leveraging Hugging Face Spaces and Supabase for Persistent Workflow Automation</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/terraform-for-data-engineers-automating-your-data-infrastructure/">Terraform for Data Engineers: Automating Your Data Infrastructure</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/etl/">etl</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/devops/">devops</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/postgres/">postgres</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/airflow/">airflow</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/application/">application</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/azure-data-studio/">azure-data-studio</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/building-a-production-ready-data-pipeline-with-airflow-and-dbt/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1745843400"
  data-df="ll"
  
>
  Apr 28, 2025
</time>

              <h4 class="pt-0 my-2">Building a Production-Ready Data Pipeline with Airflow and dbt</h4>
              <div class="text-muted">
                <p>A comprehensive walkthrough of implementing a modern sales data engineering pipeline with Airflow, dbt, and PostgreSQL, focusing on practical insights and real-world patterns.</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/building-a-scalable-etl-pipeline-for-adtech-analytics/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1745250420"
  data-df="ll"
  
>
  Apr 21, 2025
</time>

              <h4 class="pt-0 my-2">Building a Scalable ETL Pipeline for AdTech Analytics</h4>
              <div class="text-muted">
                <p>In the world of digital advertising, data is everything. Transforming raw operational data into actionable insights requires robust analytics pipelines. Recently, I implemented a comprehensive ETL ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/run-your-own-apache-spark-jobs-in-aws-emr-and-s3/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1612137600"
  data-df="ll"
  
>
  Feb  1, 2021
</time>

              <h4 class="pt-0 my-2">Run your own Apache Spark jobs in AWS EMR and S3</h4>
              <div class="text-muted">
                <p>Run your own Apache Spark jobs in AWS EMR and S3  Recently, I participated in Udacity’s Nanodegree Program for Data Engineers. It’s kinda like to review what I did past and refresh some tech stacks...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/useful-gadget-sharing-cron-job-org/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Useful gadget sharing - cron-job.org</p>
    </a>
  

  
    <a
      href="/posts/learning-and-takeaways-from-kubesimplify-workshop/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Learning and Takeaways from Kubesimplify Workshop</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/samueltyh">Samuel Tseng</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.4.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/etl/">etl</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/devops/">devops</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/postgres/">postgres</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/airflow/">airflow</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/application/">application</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/azure-data-studio/">azure-data-studio</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->

  
  <script>
  var disqus_config = function () {
    this.page.url = 'http://localhost:4000/posts/implementing-fivetran-data-source-connector-with-aws-lambda/';
    this.page.identifier = '/posts/implementing-fivetran-data-source-connector-with-aws-lambda/';
  };

  function addDisqus() {
    let disqusThread = document.createElement('div');
    let paragraph = document.createElement('p');

    disqusThread.id = 'disqus_thread';
    paragraph.className = 'text-center text-muted small';
    paragraph.innerHTML = 'Comments powered by <a href="https://disqus.com/">Disqus</a>.';
    disqusThread.appendChild(paragraph);

    const footer = document.querySelector('footer');
    footer.insertAdjacentElement("beforebegin", disqusThread);
  }function reloadDisqus(event) {
    if (event.source === window && event.data && event.data.id === Theme.ID) {if (typeof DISQUS === 'undefined') {
        return;
      }

      if (document.readyState == 'complete') {
        DISQUS.reset({ reload: true, config: disqus_config });
      }
    }
  }

  addDisqus();

  if (Theme.switchable) {
    addEventListener('message', reloadDisqus);
  }var disqusObserver = new IntersectionObserver(
    function (entries) {
      if (entries[0].isIntersecting) {
        var d = document,
          s = d.createElement('script');
        s.src = 'https://samuelTyh.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);

        disqusObserver.disconnect();
      }
    },
    { threshold: [0] }
  );

  disqusObserver.observe(document.getElementById('disqus_thread'));
</script>



    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

